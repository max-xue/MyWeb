---
title: Unity开发之工具---导表（Excel）的制作分析
categories:
  - U3D
url: 1154.html
id: 1154
comments: true
date: 2017-12-28 15:47:49
tags:
  - u3d
  - tool
---

在项目开发中，需要开发周边的工具以提高效率，比如关卡编辑工具（方便新增关卡），技能配置工具(方便调整数值)，导表工具（方便处理策划和程序中的配置数据），下面就说一下最简单的导表工具制作。 在开发过程中，项目需求是由策划提供的，他们擅长使用的工具多数是Excel。如何整理、变更和方便策划调整数值以及程序使用，都是需要预先考虑好的。 一、处理游戏中众多的数据，同样使用面向对象的方式，以关系型数据为基础来创建表及表之间的关系。 比如：关卡表![](http://www.le-more.com/wp-content/uploads/2017/12/export_tool_01-1.png) 怪物表 ![](http://www.le-more.com/wp-content/uploads/2017/12/export_tool_02.png)关卡和怪物是一对多的关系，为了减少表的数量，也便于维护，可以在同一条记录中记录多个怪物，同时为了设置在战斗场景中的尺寸，使用分割符同一列包括多个数据。 二、对于Excel表中的数据更新和维护有时候很频繁，使用一键式工具导出很有必要，如何定义在程序中的类型及导出什么格式，需要根据项目的情况来。可以导成xml,json,lua代码或自己定义的任意格式。每列定义的方式如下：![](http://www.le-more.com/wp-content/uploads/2017/12/export_tool_03.png) 第一行备注，第二行程序中定义的字段，第三行该列的类型。 以导出Json为例子，数值为空的情况是很普遍的，可以根据每列的类型，自动填充默认值，防止解析值为null的错误。 三、真实的项目表的数量会有很多，表数据有的用于客户端的有的用于服务端。同一张表的数据，各列有时候也需要区别对待，适用前端或后端。如何区分表及表中的字段，就需要一个控制表 ![](http://www.le-more.com/wp-content/uploads/2017/12/export_tool_04.png) 客户端和服务端各有一个配置表，这样就可以定制化导出数据了！ 最终工具截图，^_^ ![](http://www.le-more.com/wp-content/uploads/2017/12/export_tool_06.png)